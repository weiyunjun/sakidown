## 支持下载的内容
视频部分，SakiDown支持当前用户观看范围内非DRM加密的个人投稿/番剧/课堂，完整支持合集/播放列表/稍后再看。这意味着：
1. 无法下载你不能在线观看的视频。
2. 无法下载包含DRM加密的视频。

附件部分，SakiDown支持封面和XML弹幕下载。

## 下载流程
### 1. 刷新网页
- 如果哔哩哔哩网页是在安装插件之前打开的，那么需要**刷新**网页才可以使插件生效。
- 你也可以打开一个新的哔哩哔哩视频网页。

### 2. 下载入口
- 有两种方式唤起下载面板：
  - 点击视频页面左下方的下载按钮。
  - 在浏览器地址栏点击插件图标，在弹出的页面中点击下载视频选项。

### 3. 选择下载内容
![download](../assets/download.png)

- **默认选择**：会勾选当前页面的视频，插件初始会默认下载最佳画质的视频，不下载封面，不下载弹幕。
- **批量选择**：在弹出的列表中，勾选你想要下载的视频。支持列表顶部的一键全选。
- **策略切换**：在列表底部，你可以快速切换“下载策略”（例如：仅下载音频、最佳画质等）。关于策略的详细配置见下文。

### 4. 下载通知
- 在开始下载后，页面底部会出现一个通知横幅，你可以点击横幅的任务管理按钮，进入任务管理界面，掌控下载进度和更多内容。
- 下载会自动在后台完成，不需要保持当前网页开启（只需要保证浏览器开启）。

## 任务管理
![manager](../assets/manager.png)

打开任务管理后，在左侧有3个标签页：队列中，已完成，未完成。

### 队列中
当前正在下载以及等待下载的任务。你可以查看视频信息、下载状态、下载速度等信息，也可以手动取消任务。

### 已完成
以及完成的任务。你可以点击标题播放视频/音频，打开up主的主页，复制视频链接，打开视频所在文件夹。

### 未完成
因为各种原因下载失败的任务以及手动取消的任务。在这里会显示报错信息，可以复制视频链接，也可以重试任务或删除任务。

### 搜索任务
你可以在顶部搜索栏输入关键词搜索任务，支持搜索合集标题、分组标题、标题和UP主名称。

### 批量管理
点击顶栏的批量管理按钮，可以进入批量管理模式。批量管理模式主要用于批量取消、删除和重试任务。批量管理可以配合搜索使用。处于批量管理模式中，再次点击批量管理按钮，可以退出批量管理。

### 每页任务
在页面底部有每页任务的设置，默认每页25个任务，可以改为每页10、25、50、100个任务。

## 设置
遵循最小权限原则，目前只支持在哔哩哔哩网页中或任务管理页面打开设置功能。

### 通用
#### 视频页面显示下载按钮
开启后，在支持的视频页面的左下角，会加载一个下载按钮。默认开启。

### 任务间隔
前一个任务结束后，下一个任务需要等待的时间。默认5秒。防止请求过快被风控。

### 个性化
#### 主题色
默认提供Saki（蓝）和Anon（粉）2种主题色，你可以自行配置主题色（需要填入主题色名称和颜色码）。

### 任务完成音效
可以选择是否开启，可以自行添加本地音效文件（请不要添加文件名包含春日影的音效）。默认关闭。

### 下载策略
- **设计目的**：下载策略的初衷是为了简化批量下载的流程，应对不同下载场景的改变。
- **设置项**：你可以通过预先设置偏好（是否下载某些资源，视频的偏好画质，视频的偏好编码，是否合并音频流和视频流），来处理复杂的下载任务。
- **使用方法**：你可以在下载视频界面切换下载策略。初始一共有3个下载策略：最佳画质视频、最佳画质视频+封面+弹幕、纯音频。默认会选择最佳画质视频。
- **用户权限**：最佳画质会选择当前用户权限可以下载的最高画质视频。例如非大会员无法下载4K分辨率的视频或者仅限大会员观看的番剧。
- **画质选择**：你可以指定最佳画质外的偏好的画质，分为首选画质和次选画质。当没有符合首选画质和次选画质的视频流时，会自动选择最佳画质。
- **编码选择**：你可以指定偏好的视频编码，默认首选编码是AV1，次选编码是HEVC。前者体积较小，压缩率更高。现代播放器支持哔哩哔哩的所有3种编码格式（AV1 HEVC AVC）。
- **附件下载**：支持视频封面下载，支持XML弹幕下载。暂时不支持其他格式的弹幕文件下载。
- **空壳任务**：你可以不下载任何内容，只保存视频元数据，相当于变相的快速批量收藏，对哔哩哔哩服务器友好。